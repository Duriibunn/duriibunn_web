<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µê³µë°ì´í„° API í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        button {
            background: #14b8a6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #0d9488;
        }
        .result {
            margin-top: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            border-left: 4px solid #14b8a6;
        }
        .error {
            border-left-color: #ef4444;
            background: #fef2f2;
            color: #dc2626;
        }
        .success {
            border-left-color: #10b981;
            background: #f0fdf4;
        }
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 12px;
        }
        .info {
            background: #eff6ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3b82f6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª ê³µê³µë°ì´í„° API í…ŒìŠ¤íŠ¸</h1>
        
        <div class="info">
            <strong>API KEY:</strong> <code>b5e4c53836c78af4f7a628dc96a21af84b7d72aaf051ad37678c5ce6a7939ec9</code><br>
            <strong>Base URL:</strong> <code>https://apis.data.go.kr/B551011/KorService2</code>
        </div>

        <h2>í…ŒìŠ¤íŠ¸ ë²„íŠ¼</h2>
        <button onclick="testAreaBased()">ì œì£¼ ê´€ê´‘ì§€ ì¡°íšŒ (areaBasedList)</button>
        <button onclick="testSearch()">ë¶€ì‚° í‚¤ì›Œë“œ ê²€ìƒ‰ (searchKeyword)</button>
        <button onclick="testDirect()">ì§ì ‘ API í˜¸ì¶œ (CORS í…ŒìŠ¤íŠ¸)</button>

        <div id="result"></div>
    </div>

    <script>
        const API_KEY = 'b5e4c53836c78af4f7a628dc96a21af84b7d72aaf051ad37678c5ce6a7939ec9';
        
        function showResult(title, data, isError = false) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = 'result ' + (isError ? 'error' : 'success');
            resultDiv.innerHTML = `
                <h3>${title}</h3>
                <pre>${JSON.stringify(data, null, 2)}</pre>
            `;
        }

        async function testAreaBased() {
            console.log('ğŸ§ª Testing areaBasedList2 (ì œì£¼ ê´€ê´‘ì§€)...');
            const params = new URLSearchParams({
                serviceKey: API_KEY,
                numOfRows: '10',
                pageNo: '1',
                MobileOS: 'ETC',
                MobileApp: 'Dooribun',
                _type: 'json',
                arrange: 'A',
                areaCode: '39', // ì œì£¼
                contentTypeId: '12' // ê´€ê´‘ì§€
            });

            try {
                const url = `/api/tour/areaBasedList2?${params.toString()}`;
                console.log('ğŸ“¡ Request URL:', url);
                
                const response = await fetch(url);
                console.log('âœ… Response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('ğŸ“Š Data:', data);
                
                if (data.response.header.resultCode === '0000') {
                    const items = data.response.body.items?.item || [];
                    showResult(`âœ… ì„±ê³µ! ì œì£¼ ê´€ê´‘ì§€ ${items.length}ê°œ`, {
                        totalCount: data.response.body.totalCount,
                        items: items.slice(0, 3).map(item => ({
                            name: item.title,
                            address: item.addr1
                        }))
                    });
                } else {
                    showResult('âŒ API ì˜¤ë¥˜', data.response.header, true);
                }
            } catch (error) {
                console.error('âŒ Error:', error);
                showResult('âŒ ìš”ì²­ ì‹¤íŒ¨', { error: error.message }, true);
            }
        }

        async function testSearch() {
            console.log('ğŸ§ª Testing searchKeyword2 (ë¶€ì‚°)...');
            const params = new URLSearchParams({
                serviceKey: API_KEY,
                numOfRows: '10',
                pageNo: '1',
                MobileOS: 'ETC',
                MobileApp: 'Dooribun',
                _type: 'json',
                arrange: 'A',
                keyword: 'ë¶€ì‚°',
                contentTypeId: '12'
            });

            try {
                const url = `/api/tour/searchKeyword2?${params.toString()}`;
                console.log('ğŸ“¡ Request URL:', url);
                
                const response = await fetch(url);
                console.log('âœ… Response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('ğŸ“Š Data:', data);
                
                if (data.response.header.resultCode === '0000') {
                    const items = data.response.body.items?.item || [];
                    showResult(`âœ… ì„±ê³µ! ë¶€ì‚° ê´€ê´‘ì§€ ${items.length}ê°œ`, {
                        totalCount: data.response.body.totalCount,
                        items: items.slice(0, 3).map(item => ({
                            name: item.title,
                            address: item.addr1
                        }))
                    });
                } else {
                    showResult('âŒ API ì˜¤ë¥˜', data.response.header, true);
                }
            } catch (error) {
                console.error('âŒ Error:', error);
                showResult('âŒ ìš”ì²­ ì‹¤íŒ¨', { error: error.message }, true);
            }
        }

        async function testDirect() {
            console.log('ğŸ§ª Testing direct API call (CORS check)...');
            const params = new URLSearchParams({
                serviceKey: API_KEY,
                numOfRows: '5',
                pageNo: '1',
                MobileOS: 'ETC',
                MobileApp: 'Dooribun',
                _type: 'json',
                arrange: 'A',
                areaCode: '1', // ì„œìš¸
                contentTypeId: '12'
            });

            try {
                const url = `https://apis.data.go.kr/B551011/KorService2/areaBasedList2?${params.toString()}`;
                console.log('ğŸ“¡ Direct Request URL:', url);
                
                const response = await fetch(url);
                console.log('âœ… Response status:', response.status);
                
                const data = await response.json();
                console.log('ğŸ“Š Data:', data);
                
                if (data.response.header.resultCode === '0000') {
                    showResult('âœ… ì§ì ‘ í˜¸ì¶œ ì„±ê³µ! (CORS ì—†ìŒ)', {
                        message: 'í”„ë¡ì‹œê°€ í•„ìš”ì—†ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤',
                        totalCount: data.response.body.totalCount
                    });
                } else {
                    showResult('âŒ API ì˜¤ë¥˜', data.response.header, true);
                }
            } catch (error) {
                console.error('âŒ CORS Error:', error);
                showResult('âŒ CORS ì—ëŸ¬ ë°œìƒ', { 
                    error: error.message,
                    message: 'í”„ë¡ì‹œê°€ í•„ìš”í•©ë‹ˆë‹¤'
                }, true);
            }
        }
    </script>
</body>
</html>
